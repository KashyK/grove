!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=[],g=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"{{ AI CONSTRUCTOR }}",c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;d(this,a),this.name=b,this.hp=c,this.dmg=e,this.target=null,this.shape=new THREE.Mesh(new THREE.BoxGeometry(5,40,5),new THREE.MeshLambertMaterial({color:16777215})),f.push(this)}return e(a,[{key:"update",value:function(){for(var a in f);}}]),a}();b.exports.ai=g;new g},{}],2:[function(a,b,c){"use strict";b.exports={scene:new THREE.Scene,renderer:new THREE.WebGLRenderer({antialias:!0}),camera:new THREE.PerspectiveCamera(50,window.innerWidth/window.innerHeight,1,1e4),world:new CANNON.World,socket:io(),BODIES:{items:[],projectiles:[]},LABELS:[],PLAYERS:[],remove:{bodies:[],meshes:[]},delta:Date.now(),frustum:new THREE.Frustum,cameraViewProjectionMatrix:new THREE.Matrix4,groundMaterial:new CANNON.Material("groundMaterial")};var d=new CANNON.ContactMaterial(b.exports.groundMaterial,b.exports.groundMaterial,{friction:50,restitution:.3});b.exports.world.addContactMaterial(d);var e=a("./load");b.exports.load=e.load,b.exports.box=e.box,b.exports.label=e.label,b.exports.ball=e.ball},{"./load":9}],3:[function(a,b,c){"use strict";$("#gui").hide(),b.exports.quests=function(){$("#quest-alert > p").text("Getting Skills"),$("#quest-alert > small").text("Use the Alchemy Table to make a health potion."),setTimeout(function(){$("#quest-alert").animate({right:"-280px"},1e3)},5e3)},b.exports.inventory=function(a){$("#gui").toggle(),$("#blocker").toggle(),$("#gui-title").text("Inventory")}},{}],4:[function(a,b,c){"use strict";b.exports=function(a,b){a.scene.fog=new THREE.FogExp2(2130102,.02);var c=new THREE.AmbientLight(1118481);a.scene.add(c);var d=new THREE.SpotLight(16777215,2);d.position.set(30,10,30),d.castShadow=!0,d.shadowCameraNear=a.camera.near,d.shadowCameraFar=a.camera.far,d.shadowCameraFov=a.camera.fov,d.shadowMapBias=.0039,d.shadowMapDarkness=.5,d.shadowMapWidth=3072,d.shadowMapHeight=3072,d.shadowCameraVisible=!0,a.scene.add(d),a.scene.add(new THREE.AmbientLight(3355443));var e=new THREE.ObjectLoader;e.load("/models/"+b.serverdata.acc.map+"/"+b.serverdata.acc.map+".json",function(b){a.scene.add(b),b.castShadow=!0,b.recieveShadow=!0,b.traverse(function(b){if(b instanceof THREE.Mesh){b.castShadow=!0,b.recieveShadow=!0;a.load(b,{mass:0,material:a.groundMaterial})}})});var f=new THREE.ObjectLoader;f.load("/models/alchemy-table/alchemy-table.json",function(b){a.scene.add(b);var c=new THREE.PointLight(65280,.15);c.position.set(0,10,10),a.scene.add(c),b.traverse(function(b){if(b instanceof THREE.Mesh){var c=a.load(b,{mass:0,material:a.groundMaterial});c.mesh.position.y+=8.7,c.mesh.position.z+=20,c.body.position.y+=8.7,c.body.position.z+=20}})})}},{}],5:[function(a,b,c){"use strict";b.exports=function(){$(document).ready(function(){$("#splash-title").text("In the beginning, a Grove Tree was planted..."),setTimeout(function(){$("#splash-title").fadeOut(950),setTimeout(function(){$("#splash-title").text("It spread to make multiple trees, eventually becoming The Grove...")},950),$("#splash-title").fadeIn(950),setTimeout(function(){$("#splash-title").fadeOut(950),setTimeout(function(){$("#splash-title").text("However, Â§ome were jealous of this extreme power...")},950),$("#splash-title").fadeIn(950),setTimeout(function(){$("#splash-title").fadeOut(950),setTimeout(function(){$("#splash-title").text("12 Alchemists, of heightened skill...")},950),$("#splash-title").fadeIn(950),setTimeout(function(){$("#splash-title").fadeOut(950),setTimeout(function(){$("#splash-title").text("They attempted to create a power of their own, to combat those who had power...")},950),$("#splash-title").fadeIn(950),setTimeout(function(){$("#splash-title").fadeOut(950),setTimeout(function(){$("#splash-title").text("Eventually, they succeeded, but...")},950),$("#splash-title").fadeIn(950),setTimeout(function(){$("#splash-title").fadeOut(950),setTimeout(function(){$("#splash-title").text("Their creation consumed them, turning them into unimaginable demons...")},950),$("#splash-title").fadeIn(950),setTimeout(function(){$("#splash-title").fadeOut(950),setTimeout(function(){$("#splash-title").text("Finally, put to rest by The Developer, they were banished from these lands...")},950),$("#splash-title").fadeIn(950),setTimeout(function(){$("#splash-title").fadeOut(950),setTimeout(function(){$("#splash-title").text("Now, they are back, attacking the original Tree and its power...")},950),$("#splash-title").fadeIn(950),setTimeout(function(){$("#splash-title").fadeOut(950),setTimeout(function(){$("#splash-title").text("And it is up to you to stop them.")},950),$("#splash-title").fadeIn(950),setTimeout(function(){$("#splash-title").fadeOut(950),setTimeout(function(){$("#splash-title").text("BLARG")},950),$("#splash-title").fadeIn(950)},5e3)},5e3)},5e3)},5e3)},5e3)},5e3)},5e3)},5e3)},5e3)},5e3)})}},{}],6:[function(a,b,c){"use strict";function d(b,c){a("./world")(b),a("./bodies")(b,c),a("./player")(b),a("./dom")(b),b.renderer.shadowMapEnabled=!0,b.renderer.shadowMapSoft=!0,b.renderer.shadowCameraNear=3,b.renderer.shadowCameraFar=b.camera.far,b.renderer.shadowCameraFov=50,b.renderer.shadowMapBias=.0039,b.renderer.shadowMapDarkness=.5,b.renderer.shadowMapWidth=1024,b.renderer.shadowMapHeight=1024,b.renderer.setClearColor(b.scene.fog.color,1),b.renderer.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(b.renderer.domElement)}b.exports=d},{"./bodies":4,"./dom":5,"./player":7,"./world":8}],7:[function(a,b,c){"use strict";b.exports=function(a){var b=10,c=1.3,d=new CANNON.Sphere(c),e=new CANNON.Body({mass:b,material:a.groundMaterial});e.addShape(d),e.position.set(0,8,0),e.angularDamping=.9,a.world.add(e);var f=new THREE.Mesh(new THREE.BoxGeometry(1,2,1),new THREE.MeshLambertMaterial);f.castShadow=!0,a.scene.add(f),a.BODIES.player={body:e,shape:d,mesh:f},a.controls=new PointerLockControls(a.camera,a.BODIES.player.body),a.scene.add(a.controls.getObject()),window.controls=a.controls}},{}],8:[function(a,b,c){"use strict";b.exports=function(a){var b=new CANNON.GSSolver;a.world.defaultContactMaterial.contactEquationStiffness=1e9,a.world.defaultContactMaterial.contactEquationRelaxation=4,a.world.defaultContactMaterial.friction=2,b.iterations=7,b.tolerance=.1;var c=!1;c?a.world.solver=new CANNON.SplitSolver(b):a.world.solver=b,a.world.gravity.set(0,-20,0),a.world.broadphase=new CANNON.NaiveBroadphase}},{}],9:[function(a,b,c){"use strict";function d(a,b){b=b?b:{},a.castShadow=!0,a.recieveShadow=!0;for(var c=[],d=[],e=0;e<a.geometry.vertices.length;e++){var f=a.geometry.vertices[e];c.push(new CANNON.Vec3(f.x,f.y,f.z))}for(var e=0;e<a.geometry.faces.length;e++){var g=a.geometry.faces[e];d.push([g.a,g.b,g.c])}var h=new CANNON.ConvexPolyhedron(c,d),j=new CANNON.Body({mass:b.mass||0,material:b.material||void 0});return j.addShape(h),j.position.copy(a.position),j.quaternion.copy(a.quaternion),i.world.add(j),i.BODIES.items.push({body:j,shape:h,mesh:a}),{body:j,shape:h,mesh:a}}function e(a){a=a?a:{};var b=new CANNON.Vec3(a.l||1,a.h||1,a.w||1),c=new CANNON.Box(b),d=new THREE.BoxGeometry(2*b.x,2*b.y,2*b.z),e=new CANNON.Body({mass:a.mass||0});e.addShape(c);var f=new THREE.Mesh(d,new THREE.MeshPhongMaterial({color:16711680}));return i.world.add(e),i.scene.add(f),e.position.set(a.x||0,a.y||10,a.z||0),f.position.set(a.x||0,a.y||10,a.z||0),f.castShadow=!0,f.receiveShadow=!0,i.BODIES.items.push({body:e,shape:c,mesh:f}),{body:e,shape:c,mesh:f}}function f(a){a=a?a:{};var b=new CANNON.Sphere(a.radius||.2),c=new THREE.SphereGeometry(b.radius,32,32),d=new CANNON.Body({mass:10});d.addShape(b);var e=new THREE.Mesh(c,new THREE.MeshPhongMaterial({color:a.c||52479}));return i.world.add(d),i.scene.add(e),e.castShadow=!0,e.receiveShadow=!0,i.BODIES[a.array||"items"].push({body:d,shape:b,mesh:e}),{body:d,shape:b,mesh:e}}function g(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",c=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"run","Arial"),d=18,e=4,f={r:0,g:0,b:0,a:1},g={r:255,g:255,b:255,a:1},i=document.createElement("canvas"),j=i.getContext("2d");j.font="Bold "+d+"px "+c;var k=j.measureText(b),l=k.width;j.fillStyle="rgba("+g.r+","+g.g+","+g.b+","+g.a+")",j.strokeStyle="rgba("+f.r+","+f.g+","+f.b+","+f.a+")",j.lineWidth=e,h(j,e/2,e/2,l+e,1.4*d+e,6),j.fillStyle="rgba(0, 0, 0, 1.0)",j.fillText(b,e,d+e);var m=new THREE.Texture(i);m.needsUpdate=!0;var n=new THREE.SpriteMaterial({map:m,useScreenCoordinates:!1}),o=new THREE.Sprite(n);o.scale.set(5,2.5,1),a.add(o)}function h(a,b,c,d,e,f){a.beginPath(),a.moveTo(b+f,c),a.lineTo(b+d-f,c),a.quadraticCurveTo(b+d,c,b+d,c+f),a.lineTo(b+d,c+e-f),a.quadraticCurveTo(b+d,c+e,b+d-f,c+e),a.lineTo(b+f,c+e),a.quadraticCurveTo(b,c+e,b,c+e-f),a.lineTo(b,c+f),a.quadraticCurveTo(b,c,b+f,c),a.closePath(),a.fill(),a.stroke()}var i=a("./globals");b.exports.load=d,b.exports.box=e,b.exports.label=g,b.exports.ball=f},{"./globals":2}],10:[function(a,b,c){"use strict";function d(a){if(requestAnimationFrame(d),controls.enabled){if(f.camera.updateMatrixWorld(),f.camera.matrixWorldInverse.getInverse(f.camera.matrixWorld),f.cameraViewProjectionMatrix.multiplyMatrices(f.camera.projectionMatrix,f.camera.matrixWorldInverse),f.frustum.setFromMatrix(f.cameraViewProjectionMatrix),f.remove.bodies.length&&f.remove.meshes.length){for(var b in f.remove.bodies)f.world.remove(f.remove.bodies[b]),delete f.remove.bodies[b];for(var c in f.remove.meshes)f.scene.remove(f.remove.meshes[c]),delete f.remove.meshes[c]}for(var e=0;e<f.BODIES.projectiles.length;e++)f.BODIES.projectiles[e].mesh.position.copy(f.BODIES.projectiles[e].body.position),f.BODIES.projectiles[e].mesh.quaternion.copy(f.BODIES.projectiles[e].body.quaternion);for(var i=0;i<f.BODIES.items.length;i++)f.BODIES.items[i].mesh.position.copy(f.BODIES.items[i].body.position),f.BODIES.items[i].mesh.quaternion.copy(f.BODIES.items[i].body.quaternion);f.BODIES.player.mesh.position.copy(f.BODIES.player.body.position),$("#health-bar").val(g.hp.val/g.hp.max*100>0?g.hp.val/g.hp.max*100:0),$("#health").text(g.hp.val>0?g.hp.val:"0 HP"),g.hp.val<=0&&(f.socket.disconnect(),alert("You have died.")),f.world.step(h),f.controls.update(Date.now()-f.delta),f.renderer.render(f.scene,f.camera),f.delta=Date.now(),g&&g.serverdata&&f&&f.updatePlayerData&&(f.updatePlayerData(),f.socket.emit("updatePosition",g.serverdata))}}function e(){f.camera.aspect=window.innerWidth/window.innerHeight,f.camera.updateProjectionMatrix(),f.renderer.setSize(window.innerWidth,window.innerHeight)}var f=a("./globals"),g=a("./player"),h=1/60;a("./shooting")(f,g),a("./multiplayer")(f,g),THREE.DefaultLoadingManager.onProgress=function(b,c,e){console.log(c+" out of "+e),$("#loading-bar").width(c/e*100+"%").text(c+" / "+e+" - "+Math.floor(c/e*100)+"%"),c==e&&(d(),a("./gui").quests())},window.addEventListener("resize",e,!1)},{"./globals":2,"./gui":3,"./multiplayer":11,"./player":12,"./shooting":13}],11:[function(a,b,c){"use strict";b.exports=function(b,c){b.socket.emit("client-credentials",{username:window.__D.username,password:window.__D.password}),window.__D=void 0,delete window.__D,b.socket.emit("requestOldPlayers",{}),b.socket.on("createPlayer",function(d){"undefined"==typeof c.serverdata&&(c.serverdata=d,c.id=d.id,c.inventory=c.serverdata.acc.inventory,a("./init/manager")(b,c))}),b.socket.on("addOtherPlayer",function(a){if(a.id!==c.id){var d=b.box({l:1,w:1,h:2,mass:0});b.PLAYERS.push({body:d.body,mesh:d.mesh,id:a.id,data:a}),b.label(d.mesh,a.acc.level+" - "+a.acc.username)}}),b.socket.on("removeOtherPlayer",function(a){b.scene.remove(e(a.id).mesh),b.world.remove(e(a.id).body),console.log(a.id+" disconnected")}),b.socket.on("updatePosition",function(a){var b=e(a.id);b&&(b.body.position.x=a.x,b.body.position.y=a.y,b.body.position.z=a.z)}),b.socket.on("bullet",function(a){var c=a.pos,d=a.vel,e=b.ball({array:"projectiles"});e.body.position.set(c.x,c.y,c.z),e.body.velocity.set(d.x,d.y,d.z),e.mesh.position.set(c.x,c.y,c.z),e.body.addEventListener("collide",function(a){b.remove.bodies.push(e.body),b.remove.meshes.push(e.mesh)})}),b.socket.on("hit",function(a){a.id==c.id&&(c.hp-=a.dmg),c.hp<=0&&(alert("Why excuse me fine sir, but it appears that you are dead!"),b.socket.disconnect())});var d=function(){c.serverdata.x=b.BODIES.player.body.position.x,c.serverdata.y=b.BODIES.player.body.position.y,c.serverdata.z=b.BODIES.player.body.position.z,c.serverdata.q=b.BODIES.player.body.quaternion},e=function(a){for(var c=void 0,d=0;d<b.PLAYERS.length;d++)if(b.PLAYERS[d].id==a){c=d;break}return b.PLAYERS[c]};b.socket.on("clear",function(){for(var a=b.scene.children.length-1;a>=0;a--)b.scene.remove(b.scene.children[a])}),b.socket.on("reload",function(){window.location.reload()}),b.updatePlayerData=d,b.playerForId=e}},{"./init/manager":6}],12:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function a(){d(this,a),this.hp={val:10,max:10},this.mp={val:5,max:5},this.weapon="rock"},f=new e;window.addEventListener("keydown",function(b){try{$("#hb-"+String.fromCharCode(b.keyCode)).length?($(".hotbar").removeClass("active"),$("#hb-"+String.fromCharCode(b.keyCode)).addClass("active"),"-"!==$("#hb-"+String.fromCharCode(b.keyCode)).text()&&(f.weapon=$("#hb-"+String.fromCharCode(b.keyCode)).text().toLowerCase())):"I"==String.fromCharCode(b.keyCode)&&a("./gui").inventory(f)}catch(a){}}),b.exports=f},{"./gui":3}],13:[function(a,b,c){"use strict";b.exports=function(a,b){function c(b){var c=new THREE.Projector,d=b;b.set(0,0,1),c.unprojectVector(d,a.camera);var e=new THREE.Ray(a.BODIES.player.body.position,d.sub(a.BODIES.player.body.position).normalize());b.copy(e.direction)}function d(d){1==a.controls.enabled&&!function(){var d=new THREE.Vector3,e=20,f=a.BODIES.player.body.position.x,g=a.BODIES.player.body.position.y,h=a.BODIES.player.body.position.z,i=a.ball({array:"projectiles",c:"rock"==b.weapon?13421772:16729344});c(d),i.body.velocity.set(d.x*e,d.y*e,d.z*e),f+=d.x*(1.02*a.BODIES.player.shape.radius+i.shape.radius),g+=d.y*(1.02*a.BODIES.player.shape.radius+i.shape.radius),h+=d.z*(1.02*a.BODIES.player.shape.radius+i.shape.radius),i.body.position.set(f,g,h),i.mesh.position.set(f,g,h),i.id=Math.random(),i.body.addEventListener("collide",function(b){var c=b.contact;if(c.bj.id!=i.body.id)for(var d in a.PLAYERS)c.bj==a.PLAYERS[d].body&&a.socket.emit("hit-player",a.PLAYERS[d].id);setTimeout(function(){a.remove.bodies.push(i.body),a.remove.meshes.push(i.mesh)},1500)}),a.socket.emit("bullet",{pos:{x:f,y:g,z:h},vel:{x:i.body.velocity.x,y:i.body.velocity.y,z:i.body.velocity.z}})}()}window.addEventListener("click",d)}},{}]},{},[1,2,3,4,5,6,7,8,9,10,11,12,13]);