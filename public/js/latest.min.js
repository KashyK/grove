!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=[],g=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"{{ AI CONSTRUCTOR }}",c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;d(this,a),this.name=b,this.hp=c,this.dmg=e,this.target=null,this.shape=new THREE.Mesh(new THREE.BoxGeometry(5,40,5),new THREE.MeshLambertMaterial({color:16777215})),f.push(this)}return e(a,[{key:"update",value:function(){for(var a in f);}}]),a}();b.exports.ai=g;new g},{}],2:[function(a,b,c){"use strict"},{}],3:[function(a,b,c){"use strict";a("./items"),b.exports={scene:new THREE.Scene,renderer:new THREE.WebGLRenderer({antialias:!0,preserveDrawingBuffer:!0,alpha:!0}),camera:new THREE.PerspectiveCamera(70,window.innerWidth/window.innerHeight,1,2e4),world:new CANNON.World,socket:io(),composers:[],BODIES:{items:[],projectiles:[]},LABELS:[],PLAYERS:[],EMITTERS:[],TWEENS:[],remove:{bodies:[],meshes:[],tweens:[]},listener:new THREE.AudioListener,delta:Date.now(),clock:new THREE.Clock,frustum:new THREE.Frustum,cameraViewProjectionMatrix:new THREE.Matrix4,groundMaterial:new CANNON.Material("groundMaterial")};var d=new CANNON.ContactMaterial(b.exports.groundMaterial,b.exports.groundMaterial,{friction:50,restitution:.3});b.exports.world.addContactMaterial(d);var e=a("./load");b.exports.load=e.load,b.exports.box=e.box,b.exports.label=e.label,b.exports.ball=e.ball,b.exports.plane=e.plane},{"./items":9,"./load":13}],4:[function(a,b,c){"use strict";function d(a){f.clearRect(0,0,e.width,e.height);var b=f.createLinearGradient(0,0,a.xp.xp/a.xp.max*e.width,0);b.addColorStop(0,"darkgreen"),b.addColorStop(.75,"darkgreen"),b.addColorStop(.95,"lime"),b.addColorStop(1,"lime"),f.fillStyle=b,f.fillRect(0,e.height-10,a.xp.xp/a.xp.max*e.width,10),f.save(),f.beginPath(),f.arc(g,e.height-h,h,0,2*Math.PI,!1),f.clip(),f.fillStyle="#cc0000",f.fillRect(g-h,e.height,2*h,-(a.hp.val/a.hp.max)*h*2),f.restore(),f.beginPath(),f.arc(g,e.height-h,h,0,2*Math.PI,!1),f.lineWidth=6,b=f.createLinearGradient(0,0,0,2*h),b.addColorStop(0,"grey"),b.addColorStop(1,"black"),f.strokeStyle=b,f.stroke(),f.fillStyle="black",f.textAlign="center",f.fillText((a.hp.val>0?Math.floor(a.hp.val):0)+" HP",g,e.height-h);for(var c=[-100,-170,-240,-310,-380,100,170,240,310,380],d=[5,4,3,2,1,6,7,8,9],i=0;i<c.length;i++)f.strokeStyle="#000",d[a.hotbar.selected]==i&&100!==Math.abs(c[i])&&(f.strokeStyle="#ddd"),f.lineWidth=3,f.strokeRect(g+c[i]-25,e.height-70,50,50),100==c[i]&&(f.fillText("LH",g-100,e.height-h),f.fillText("RH",g+100,e.height-h));if(a.hotbar.list[0]&&/sword/gi.test(a.hotbar.list[0].name)){var j=new Image;j.src="/img/icons/two-handed-sword.svg",f.drawImage(j,g-380-25,e.height-70,50,50)}}b.exports=function(a,b){$("#quest-alert").css("right","0px"),$("#quest-alert > p").text(a),$("#quest-alert > small").text(b),setTimeout(function(){$("#quest-alert").animate({right:"-280px"},1e3)},5e3)},b.exports.init=function(a){$("#gui").toggle(),$("#underlay").toggle(),$("#load-play-btn").hide(),$("#gui-exit").click(function(){$("#gui").toggle(),$("#underlay").toggle()}),setInterval(function(){return d(a)},10)},b.exports.quests=function(){$("#quest-alert > p").text("Getting Skills"),$("#quest-alert > small").text("Use the Alchemy Table to make a health potion."),setTimeout(function(){$("#quest-alert").animate({right:"-280px"},1e3)},1e4)},b.exports.hotbar=function(a){for(var b=0;b<8;b++)$("#hb-"+b).html("-");for(var c=0;c<a.hotbar.list.length;c++)$("#hb-"+(c+1)).text(a.hotbar.list[c].name).data("item",a.hotbar.list[c])},b.exports.stats=function(c){$("#gui").show(),$("#underlay").show(),$("#gui-title").text(""),$("#gui-content").html("<h1 style=margin-top:21.5%;text-align:center;width:90%;color:white>\n    <span id=gui-q>quests</span> | <span id=gui-i>inventory</span> | <span id=gui-m>map</span> | <span id=gui-p>player</span>\n    </h1>"),$("#gui-q").click(function(){$("#gui-title").html("Quests"),$("#gui-content").html("questy stuff")}),$("#gui-i").click(function(){$("#gui-title").html("Inventory"),$("#gui-content").html("");var a=function(a){$(document.createElement("span")).html(c.inventory[a].name).click(function(d){c.hotbar.list.indexOf(c.inventory[a])==-1?(c.hotbar.list.push(c.inventory[a]),b.exports.hotbar(c),$(d.target).css("background-color","blue")):(c.hotbar.list.splice(c.hotbar.list.indexOf(c.inventory[a]),1),b.exports.hotbar(c),$(d.target).css("background-color","transparent"))}).css("background-color",0==c.hotbar.list.indexOf(c.inventory[a])?"blue":"transparent").appendTo($("#gui-content"))};for(var d in c.inventory)a(d)}),$("#gui-m").click(function(){$("#gui-title").html("Map");var b="image/jpeg",c=a("./globals").renderer.domElement.toDataURL(b);$("#gui-content").html("<img src="+c+" width=200>")}),$("#gui-p").click(function(){$("#gui-title").html("Player"),$("#gui-content").html("ur stats")}),$("#gui-content").is(":visible")&&document.exitPointerLock()};var e=document.getElementById("hp-bar");e.setAttribute("width",.7*window.innerWidth);var f=e.getContext("2d"),g=e.width/2,h=(e.height/2,40)},{"./globals":3}],5:[function(a,b,c){"use strict";b.exports=function(a,b){a.scene.fog=new THREE.Fog(16777215,2);var c=new THREE.DirectionalLight(16777215,1);c.position.set(50,30,40),c.castShadow=!0,c.shadowCameraNear=a.camera.near,c.shadowCameraFar=a.camera.far,c.shadowCameraFov=70,c.shadowCameraLeft=-400,c.shadowCameraRight=400,c.shadowCameraTop=100,c.shadowCameraBottom=-300,c.shadowMapBias=.0036,c.shadowMapDarkness=.5,c.shadowMapWidth=4096,c.shadowMapHeight=4096,c.shadowCameraVisible=!0,a.scene.add(c);var d=new THREE.SpriteMaterial({map:new THREE.ImageUtils.loadTexture("/img/glow.png"),color:16755370,transparent:!1,blending:THREE.AdditiveBlending}),e=new THREE.Sprite(d);e.scale.set(100,100,1),c.add(e);var f={time:{value:1},resolution:{value:new THREE.Vector2}};setInterval(function(){f.time.value+=.1;var a=2.1,b=Math.sin(a),d=Math.cos(a);c.position.set(450*b,600*b,600*d)},40);var g=new THREE.HemisphereLight(16777215,16777215,.2);g.color.setHSL(.6,1,.6),g.groundColor.setHSL(.095,1,.75),g.position.set(0,500,0),a.scene.add(g);var h="/img/skybox/",i=["px","nx","py","ny","pz","nz"],j=".jpg",k=new THREE.CubeGeometry(2e3,2e3,2e3);a.ball({mass:1,radius:5,pos:{x:10,y:7.5,z:10}});for(var l=[],m=0;m<6;m++)l.push(new THREE.MeshBasicMaterial({map:THREE.ImageUtils.loadTexture(h+i[m]+j),side:THREE.BackSide,fog:!1}));var n=new THREE.MeshFaceMaterial(l),o=new THREE.Mesh(k,n);a.BODIES.player.mesh.add(o);var p=new THREE.ObjectLoader;p.load("/models/skjar-isles/skjar-isles.json",function(b){a.scene.add(b),b.castShadow=!0,b.recieveShadow=!0,b.traverse(function(b){if(b instanceof THREE.Mesh){b.castShadow=!0,b.recieveShadow=!0;var c=void 0;if(/NP/gi.test(b.name)||(c=a.load(b,{mass:0,material:a.groundMaterial})),/portal/gi.test(b.name)&&(b.material=new THREE.ShaderMaterial({uniforms:f,vertexShader:document.getElementById("V_PortalShader").textContent,fragmentShader:document.getElementById("F_PortalShader").textContent}),b.add(new THREE.PointLight(16777215,1,25,2))),/bridge/gi.test(b.name)){var d=new TWEEN.Tween(b.rotation).to({y:-Math.PI/8},4e3).repeat(1/0).yoyo(!0).start();a.TWEENS.push(d)}}})})}},{}],6:[function(a,b,c){"use strict";function d(b,c){a("./world")(b),a("./player")(b,c),a("./bodies")(b,c),b.renderer.shadowMapEnabled=!0,b.renderer.shadowMapSoft=!0,b.renderer.shadowMapType=THREE.PCFShadowMap,b.renderer.shadowCameraNear=3,b.renderer.shadowCameraFar=b.camera.far,b.renderer.shadowCameraFov=50,b.renderer.shadowMapBias=1e-4,b.renderer.shadowMapDarkness=.5,b.renderer.shadowMapWidth=1024,b.renderer.shadowMapHeight=1024,b.renderer.setClearColor(b.scene.fog.color,1),b.renderer.setSize(window.innerWidth,window.innerHeight),b.camera.add(b.listener),document.body.appendChild(b.renderer.domElement)}b.exports=d},{"./bodies":5,"./player":7,"./world":8}],7:[function(a,b,c){"use strict";b.exports=function(a,b){var c=100,d=1.7,e=new CANNON.Sphere(d),f=new CANNON.Body({mass:c,material:a.groundMaterial});f.addShape(e),f.position.set(0,30,0),f.angularDamping=.9,a.world.add(f),f.addEventListener("collide",function(a){var c=a.contact,d=new CANNON.Vec3(0,1,0),e=new CANNON.Vec3;c.bi.id==f.id?c.ni.negate(e):e.copy(c.ni),e.dot(d)>.5&&f.velocity.y<=-60&&(b.hp.val+=Math.floor(f.velocity.y/10))});var g=new THREE.Mesh(new THREE.BoxGeometry(1,2,1),new THREE.MeshLambertMaterial);g.castShadow=!0,a.scene.add(g),a.BODIES.player={body:f,shape:e,mesh:g},a.controls=new PointerLockControls(a.camera,a.BODIES.player.body),a.scene.add(a.controls.getObject()),window.controls=a.controls}},{}],8:[function(a,b,c){"use strict";b.exports=function(a){var b=new CANNON.GSSolver;a.world.defaultContactMaterial.contactEquationStiffness=1e9,a.world.defaultContactMaterial.contactEquationRelaxation=4,a.world.defaultContactMaterial.friction=2,b.iterations=7,b.tolerance=.1;var c=!1;c?a.world.solver=new CANNON.SplitSolver(b):a.world.solver=b,a.world.gravity.set(0,-40,0),a.world.broadphase=new CANNON.NaiveBroadphase}},{}],9:[function(a,b,c){"use strict";function d(a,b){var c=g.get(a),d=g.get(b);return c.mat=d,c.dmg=d.dmg,c.spd=d.spd,c.dur=d.dur,c.name=d.name+c.name,c}function e(a,b,c){var e=g.get(a?"longsword":"shortsword"),f=d("@blade",b),h=d("@handle",c);return e.blade=f,e.handle=h,e.name=f.mat.name+" "+e.name,e.dmg=(f.dmg+h.dmg)/2,e.spd=(f.spd+h.spd)/2,e}var f=a("rpg-tools/lib/ProtoTree"),g=null,h=a("./json/base"),i=a("./json/weapons"),j=a("./json/mats");Object.assign(h,i,j),g=new f(h),b.exports=function(a){a(g,d,e)}},{"./json/base":10,"./json/mats":11,"./json/weapons":12,"rpg-tools/lib/ProtoTree":18}],10:[function(a,b,c){b.exports={"@item":{name:"-- Item --",desc:"If you see this, please contact developers",weight:0,ench:{}},"@weapon":{proto:"@item",name:"-- Weapon --",dmg:0,spd:0,knbk:0,slot:0,cost:{}},"@sword":{proto:"@weapon",name:"-- Sword --",blade:{},handle:{}},"@blade":{proto:"@weapon",name:"-- Blade --",mat:{}},"@handle":{proto:"@weapon",name:"-- Handle --",mat:{}},"@bow":{proto:"@weapon",name:"-- Bow --",body:{},string:{}},"@body":{proto:"@weapon",name:"-- Bow Body --",mat:{}},"@string":{proto:"@weapon",name:"-- Bowstring --",mat:{}},"@spell":{proto:"@weapon",name:"-- Spell --",weight:0},"@material":{proto:"@item",dur:0,spd:0,dmg:0}}},{}],11:[function(a,b,c){b.exports={wood:{proto:"@material",name:"Wood",desc:"A block of wood.  Interesting.",weight:2,dmg:3,dur:1,spd:4},iron:{proto:"@material",name:"Iron",desc:"A bar of iron for all of your irony needs",weight:5,dmg:7,dur:3,spd:3},steel:{proto:"@material",name:"Steel",desc:"A rod of steel, a steel rod",weight:6,dmg:12,dur:5,spd:3},ebony:{proto:"@material",name:"Ebony",desc:"Like ebay, but ebony",weight:10,dmg:16,dur:8,spd:2},ivory:{proto:"@material",name:"Ivory",desc:"A fine, delicate material",weight:.5,dmg:2,dur:1,spd:15},dragonivory:{proto:"ivory",name:"Dragon Ivory",desc:"Carved from the scales of the finest dragons in The Grove",dmg:4,dur:2}}},{}],12:[function(a,b,c){b.exports={shortsword:{proto:"@sword",name:"Shortsword",desc:"A shortened sword",slot:1},longsword:{proto:"@sword",name:"Longsword",desc:"Slonglord!  Wait a sec...",slot:2}}},{}],13:[function(a,b,c){"use strict";function d(a,b){b=b?b:{},a.castShadow=!0,a.recieveShadow=!0;for(var c=[],d=[],e=0;e<a.geometry.vertices.length;e++){var f=a.geometry.vertices[e];c.push(new CANNON.Vec3(f.x,f.y,f.z))}for(var e=0;e<a.geometry.faces.length;e++){var g=a.geometry.faces[e];d.push([g.a,g.b,g.c])}var h=new CANNON.ConvexPolyhedron(c,d),i=new CANNON.Body({mass:b.mass||0,material:b.material||void 0});return i.addShape(h),i.position.copy(a.position),i.quaternion.copy(a.quaternion),j.world.add(i),j.BODIES.items.push({body:i,shape:h,mesh:a}),{body:i,shape:h,mesh:a}}function e(a){a=a?a:{};var b=new CANNON.Vec3(void 0!==a.l?a.l:1,void 0!==a.h?a.h:1,void 0!==a.w?a.w:1),c=new CANNON.Box(b),d=new THREE.BoxGeometry(2*b.x,2*b.y,2*b.z),e=new CANNON.Body({mass:a.mass||0});e.addShape(c);var f=new THREE.Mesh(d,void 0!==a.mat?a.mat:new THREE.MeshPhongMaterial({color:16711680}));return j.world.add(e),j.scene.add(f),f.castShadow=!0,f.receiveShadow=!0,a.pos?e.position.set(a.pos.x,a.pos.y,a.pos.z):null,j.BODIES.items.push({body:e,shape:c,mesh:f}),{body:e,shape:c,mesh:f}}function f(a){a=a?a:{};var b=new CANNON.Sphere(a.radius||.2),c=new THREE.SphereGeometry(b.radius,32,32),d=new CANNON.Body({mass:void 0!==a.mass?a.mass:10});d.addShape(b);var e=new THREE.Mesh(c,a.mat||new THREE.MeshPhongMaterial({color:a.c||52479}));return j.world.add(d),j.scene.add(e),e.castShadow=!0,e.receiveShadow=!0,j.BODIES[a.array||"items"].push({body:d,shape:b,mesh:e}),a.pos?d.position.set(a.pos.x,a.pos.y,a.pos.z):null,{body:d,shape:b,mesh:e}}function g(a){var b=new THREE.PlaneGeometry(5,20,32),c=new THREE.MeshBasicMaterial({color:16776960,side:THREE.DoubleSide}),d=new THREE.Mesh(b,c);j.scene.add(d);var e=new CANNON.Plane,f=new CANNON.Body({mass:0,shape:e});return j.world.add(f),j.BODIES[a.array||"items"].push({body:f,shape:e,mesh:d}),{body:f,shape:e,mesh:d}}function h(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",c=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"run","Arial"),d=18,e=4,f={r:0,g:0,b:0,a:1},g={r:255,g:255,b:255,a:1},h=document.createElement("canvas"),j=h.getContext("2d");j.font="Bold "+d+"px "+c;var k=j.measureText(b),l=k.width;j.fillStyle="rgba("+g.r+","+g.g+","+g.b+","+g.a+")",j.strokeStyle="rgba("+f.r+","+f.g+","+f.b+","+f.a+")",j.lineWidth=e,i(j,e/2,e/2,l+e,1.4*d+e,6),j.fillStyle="rgba(0, 0, 0, 1.0)",j.fillText(b,e,d+e);var m=new THREE.Texture(h);m.needsUpdate=!0;var n=new THREE.SpriteMaterial({map:m,useScreenCoordinates:!1}),o=new THREE.Sprite(n);o.scale.set(5,2.5,1),a.add(o)}function i(a,b,c,d,e,f){a.beginPath(),a.moveTo(b+f,c),a.lineTo(b+d-f,c),a.quadraticCurveTo(b+d,c,b+d,c+f),a.lineTo(b+d,c+e-f),a.quadraticCurveTo(b+d,c+e,b+d-f,c+e),a.lineTo(b+f,c+e),a.quadraticCurveTo(b,c+e,b,c+e-f),a.lineTo(b,c+f),a.quadraticCurveTo(b,c,b+f,c),a.closePath(),a.fill(),a.stroke()}var j=a("./globals");b.exports.load=d,b.exports.box=e,b.exports.label=h,b.exports.ball=f,b.exports.plane=g},{"./globals":3}],14:[function(a,b,c){"use strict";function d(a){if(window.controls&&window.controls.enabled){if(f.remove.bodies.length&&f.remove.meshes.length){for(var b in f.remove.bodies)f.world.remove(f.remove.bodies[b]),delete f.remove.bodies[b];for(var c in f.remove.meshes)f.scene.remove(f.remove.meshes[c]),delete f.remove.meshes[c]}else if(f.remove.tweens.length)for(var e in f.remove.tweens)f.TWEENS[f.remove.bodies[e]].stop(),delete f.remove.tweens[e];for(var i=0;i<f.BODIES.projectiles.length;i++)f.BODIES.projectiles[i].mesh.position.copy(f.BODIES.projectiles[i].body.position),f.BODIES.projectiles[i].mesh.quaternion.copy(f.BODIES.projectiles[i].body.quaternion);for(var j=0;j<f.BODIES.items.length;j++)f.BODIES.items[j].mesh.position.copy(f.BODIES.items[j].body.position),f.BODIES.items[j].mesh.quaternion.copy(f.BODIES.items[j].body.quaternion);for(var k in f.TWEENS)f.TWEENS[k].update(a);if(f.BODIES.player.mesh.position.copy(f.BODIES.player.body.position),f.BODIES.player.body.position.y<-400&&g.hp.val--,$("#health-bar").val(g.hp.val/g.hp.max*100>0?g.hp.val/g.hp.max*100:0),$("#health").text((g.hp.val>0?g.hp.val:0)+" HP"),g.hp.val<=0)return f.socket.disconnect(),$("#blocker").fadeIn(5e3),void $("#load").show().html("<h1>You Have Perished. Game Over...</h1>");f.world.step(h),f.controls.update(Date.now()-f.delta),f.renderer.render(f.scene,f.camera),f.delta=Date.now(),g&&g.serverdata&&f&&f.updatePlayerData&&(f.updatePlayerData(),f.socket.emit("updatePosition",g.serverdata))}requestAnimationFrame(d)}function e(){f.camera.aspect=window.innerWidth/window.innerHeight,f.camera.updateProjectionMatrix(),f.renderer.setSize(window.innerWidth,window.innerHeight)}var f=a("./globals"),g=a("./player"),h=1/60;a("./items"),a("./gui").init(g),a("./shooting")(f,g),a("./multiplayer")(f,g),THREE.DefaultLoadingManager.onProgress=function(b,c,e){console.log(c+" out of "+e),c==e&&($("#spinner").hide(),$("#load-play-btn, .play-btn").show(),d(),a("./gui").quests())},window.addEventListener("resize",e,!1)},{"./globals":3,"./gui":4,"./items":9,"./multiplayer":15,"./player":16,"./shooting":17}],15:[function(a,b,c){"use strict";b.exports=function(b,c){$(window).bind("online",function(){return Materialize.toast("Connection restored",4e3)}),$(window).bind("offline",function(){return Materialize.toast("Connection lost",4e3)}),b.socket.emit("client-credentials",{username:window.__D.username,password:window.__D.password}),window.__D=void 0,delete window.__D,b.socket.emit("requestOldPlayers",{}),b.socket.on("createPlayer",function(d){"undefined"==typeof c.serverdata&&(c.serverdata=d,c.id=d.id,Object.assign(c.inventory,c.serverdata.acc.inventory),a("./init/manager")(b,c))}),b.socket.on("addOtherPlayer",function(a){a.id!==c.id&&!function(){var c=b.box({l:1,w:1,h:2,mass:0}),d=new THREE.ObjectLoader;d.load("/models/sword/sword.json",function(a){a.scale.set(.2,.2,.2),a.castShadow=!0,c.mesh.add(a),a.position.x+=.7,a.position.y-=.375,a.position.z-=1.25}),b.PLAYERS.push({body:c.body,mesh:c.mesh,id:a.id,data:a}),b.label(c.mesh,a.acc.level+" - "+a.acc.username),Materialize.toast("<span style='color:lightblue'>"+a.acc.username+" joined</span>",4e3)}()}),b.socket.on("removeOtherPlayer",function(a){b.scene.remove(e(a.id).mesh),b.world.remove(e(a.id).body),Materialize.toast(a.acc.username+" left",4e3),console.log(a.id+" disconnected")}),b.socket.on("updatePosition",function(a){var b=e(a.id);b&&(b.body.position.x=a.x,b.body.position.y=a.y,b.body.position.z=a.z)}),b.socket.on("bullet",function(a){var c=a.pos,d=a.vel,e=b.ball({array:"projectiles"});e.body.position.set(c.x,c.y,c.z),e.body.velocity.set(d.x,d.y,d.z),e.mesh.position.set(c.x,c.y,c.z),e.body.addEventListener("collide",function(a){setTimeout(function(){b.remove.bodies.push(e.body),b.remove.meshes.push(e.mesh)},1500)})}),b.socket.on("hit",function(a){a.id==c.id&&c.hp.val--});var d=function(){c.serverdata.x=b.BODIES.player.body.position.x,c.serverdata.y=b.BODIES.player.body.position.y,c.serverdata.z=b.BODIES.player.body.position.z,c.serverdata.q=b.BODIES.player.body.quaternion},e=function(a){for(var c=void 0,d=0;d<b.PLAYERS.length;d++)if(b.PLAYERS[d].id==a){c=d;break}return b.PLAYERS[c]};b.socket.on("chat-msg",function(a,b){Materialize.toast(a+": "+b,1e4)});var f=0;$(window).on("keydown",function(a){13==a.keyCode&&$("#chat-input").is(":focus")&&f<5?(b.socket.emit("chat-msg",c.serverdata.acc.username,$("#chat-input").val()),$("#chat-input").val(""),$("#chat-input").blur(),f++,setTimeout(function(){f--},5e3)):84!=a.keyCode||$("#chat-input").is(":focus")||setTimeout(function(){$("#chat-input").focus(),$("#chat-input").val(" ")},100)}),b.socket.on("clear",function(){for(var a=b.scene.children.length-1;a>=0;a--)b.scene.remove(b.scene.children[a])}),b.socket.on("reload",function(){return window.location.reload()}),b.updatePlayerData=d,b.playerForId=e}},{"./init/manager":6}],16:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function b(){var c=this;d(this,b),this.hp={val:10,max:10},this.mp={val:5,max:5},this.xp={level:0,xp:3,max:10},this.equipped={weapon:null},this.inventory=[],this.hotbar={list:[],selected:1,active:null},a("./items")(function(a,b,d){var e=d(0,"iron","wood");e.slot="weapon",c.inventory.push(e)})},f=new e;b.exports=f},{"./items":9}],17:[function(a,b,c){"use strict";b.exports=function(b,c){function d(){c.equipped.weapon&&/sword/gi.test(c.equipped.weapon.name)&&!f?(f=e.clone(),b.camera.add(f),window.addEventListener("mousedown",function(){if(f){var a=new TWEEN.Tween(f.rotation).to({x:[-Math.PI/2,0]},1/c.equipped.weapon.spd*2e3).onStart(function(){var a=new Audio("/audio/sword.mp3");a.play()}).start();b.TWEENS.push(a)}})):c.equipped.weapon||(b.camera.remove(f),f=null)}var e=void 0,f=void 0,g=new THREE.ObjectLoader;g.load("/models/sword/sword.json",function(a){e=a,e.scale.set(.1,.1,.1),e.castShadow=!0,e.position.x++,e.position.y-=1.2,e.position.z-=1.25}),setInterval(d,500),$(document).on("keydown",function(d){if("E"==String.fromCharCode(d.keyCode)){var e=new THREE.Raycaster;e.set(b.camera.getWorldPosition(),b.camera.getWorldDirection());var f=e.intersectObjects(b.scene.children,!0);f.length>0&&/door/gi.test(f[0].object.name)&&b.socket.emit("map-update",{username:c.serverdata.acc.username,password:c.serverdata.acc.password,map:"skjar-isles"})}"Q"==String.fromCharCode(d.keyCode)&&a("./gui").stats(c);try{var g=Number(String.fromCharCode(d.keyCode));"number"==typeof g&&!isNaN(g)&&g>=1&&g<=8&&(c.hotbar.selected=g,c.hotbar.list[g]&&(c.equipped.weapon=c.hotbar.list[g]),alert(JSON.stringify(c.equipped.weapon)))}catch(a){}})}},{"./gui":4}],18:[function(a,b,c){!function(d,e){"use strict";"function"==typeof define&&define.amd?define(["./utils"],e):"object"==typeof c?b.exports=e(a("./utils")):(d.rpgTools=d.rpgTools||{},d.rpgTools.ProtoTree=e(d.rpgTools.utils))}(this,function(a){"use strict";function b(a){this._tree=a,this._processed=Object.create(null)}return b.prototype={constructor:b,derive:function(a){var b=this._processed[a.proto];if(b)return this.deepDefaults(a,b);if(b=this._tree[a.proto],!b)throw new TypeError("Invalid proto specified for "+a.name);return a.proto=b.proto,this.deepDefaults(a,b)},get:function(a){var b=this._processed[a];if(b)return b;if(b=this._tree[a],!b)throw new RangeError("No such object in given tree as "+a);for(;"proto"in b&&b.proto;)b=this.derive(b);return delete b.proto,this._processed[a]=b,b},deepDefaults:function(b,c){return Object.keys(c).forEach(function(d){a.isObject(c[d])?(void 0===b[d]&&(b[d]={}),b[d]=this.deepDefaults(b[d],c[d])):Array.isArray(c[d])?(void 0===b[d]&&(b[d]=[]),b[d]=this.deepDefaults(b[d],c[d])):void 0===b[d]&&(b[d]=c[d])},this),b}},b})},{"./utils":19}],19:[function(a,b,c){!function(a,d){"use strict";"function"==typeof define&&define.amd?define([],d):"object"==typeof c?b.exports=d():(a.rpgTools=a.rpgTools||{},a.rpgTools.utils=d())}(this,function(){"use strict";function a(a){return"[object String]"===f.call(a)}function b(a){return"[object Number]"===f.call(a)}function c(a){var b=typeof a;return!Array.isArray(a)&&"object"===b&&!!a}function d(a,b,c){var d=b.split(".");if(1===d.length)return 2===arguments.length?a[b]:(a[b]=c,c);var e=1,f=d.length,g=d[0],h=a[g];if(2===arguments.length){for(;e<f;)g=d[e],h=h[g],e++;return h}for(;e<f-1;)g=d[e],h=h[g],e++;return h[d[e]]=c,c}function e(a){return c(a)?JSON.parse(JSON.stringify(a)):a}var f=Object.prototype.toString,g={isString:a,isNumber:b,isObject:c,keyPath:d,clone:e};return g})},{}]},{},[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17]);