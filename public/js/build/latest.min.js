!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";b.exports={scene:new THREE.Scene,renderer:new THREE.WebGLRenderer({antialias:!0}),camera:new THREE.PerspectiveCamera(50,window.innerWidth/window.innerHeight,1,1e4),world:new CANNON.World,MESHES:{items:[],projectiles:[]},BODIES:{items:[],projectiles:[]},LABELS:[],otherPlayers:[],otherPlayersId:[],delta:Date.now(),frustum:new THREE.Frustum,cameraViewProjectionMatrix:new THREE.Matrix4},b.exports.rendererDEBUG=new THREE.CannonDebugRenderer(b.exports.scene,b.exports.world)},{}],2:[function(a,b,c){"use strict";b.exports=function(a){var b=new CANNON.Plane,c=new CANNON.Body({mass:0});c.addShape(b),c.quaternion.setFromAxisAngle(new CANNON.Vec3(1,0,0),-Math.PI/2),a.world.add(c),a.scene.fog=new THREE.FogExp2(1114129,.02);var d=new THREE.AmbientLight(1118481);a.scene.add(d);var e=new THREE.SpotLight(16777215);e.position.set(10,30,20),e.target.position.set(0,0,0),e.castShadow=!0,e.shadowCameraNear=a.camera.near,e.shadowCameraFar=a.camera.far,e.shadowCameraFov=a.camera.fov,e.shadowMapBias=-1,e.shadowMapDarkness=.5,e.shadowMapWidth=2048,e.shadowMapHeight=2048,e.shadowCameraVisible=!0,a.scene.add(e);var f=new THREE.PlaneGeometry(300,300,50,50);f.applyMatrix((new THREE.Matrix4).makeRotationX(-Math.PI/2));var g=new THREE.Mesh(f,new THREE.MeshLambertMaterial({color:65280,shininess:10}));g.castShadow=!0,g.receiveShadow=!0,a.scene.add(g)}},{}],3:[function(a,b,c){"use strict";function d(b){a("./world")(b),a("./bodies")(b),a("./player")(b),b.renderer.shadowMapEnabled=!0,b.renderer.shadowMapSoft=!0,b.renderer.setClearColor(b.scene.fog.color,1),b.renderer.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(b.renderer.domElement)}b.exports=d},{"./bodies":2,"./player":4,"./world":5}],4:[function(a,b,c){"use strict";b.exports=function(a){var b=5,c=1.3,d=new CANNON.Sphere(c),e=new CANNON.Body({mass:b});e.addShape(d),e.position.set(0,5,0),e.angularDamping=.9,a.world.add(e),a.BODIES.player={body:e,shape:d},a.MESHES.player=new THREE.Mesh(new THREE.BoxGeometry(1,2.5,1),new THREE.MeshLambertMaterial),a.MESHES.player.castShadow=!0,a.scene.add(a.MESHES.player),a.controls=new PointerLockControls(a.camera,a.BODIES.player.body),a.scene.add(a.controls.getObject()),window.controls=a.controls}},{}],5:[function(a,b,c){"use strict";b.exports=function(a){var b=new CANNON.GSSolver;a.world.defaultContactMaterial.contactEquationStiffness=1e9,a.world.defaultContactMaterial.contactEquationRelaxation=4,a.world.defaultContactMaterial.friction=1e9,b.iterations=7,b.tolerance=.1;var c=!0;c?a.world.solver=new CANNON.SplitSolver(b):a.world.solver=b,a.world.gravity.set(0,-20,0),a.world.broadphase=new CANNON.NaiveBroadphase}},{}],6:[function(a,b,c){"use strict";b.exports=function(a){function b(b,c){c=c?c:{},b.castShadow=!0,b.recieveShadow=!0;for(var d=[],e=[],f=0;f<b.geometry.vertices.length;f++){var g=b.geometry.vertices[f];d.push(new CANNON.Vec3(g.x,g.y,g.z))}for(var f=0;f<b.geometry.faces.length;f++){var h=b.geometry.faces[f];e.push([h.a,h.b,h.c])}var i=new CANNON.ConvexPolyhedron(d,e),j=new CANNON.Body({mass:c.mass||0});return j.addShape(i),j.position.copy(b.position),j.quaternion.copy(b.quaternion),a.world.add(j),a.BODIES.items.push({body:j,shape:i,mesh:b}),{body:j,shape:i,mesh:b}}function c(b){b=b?b:{};var c=new CANNON.Vec3(b.l||1,b.h||1,b.w||1),d=new CANNON.Box(c),e=new THREE.BoxGeometry(2*c.x,2*c.y,2*c.z),f=new CANNON.Body({mass:b.mass||0});f.addShape(d);var g=new THREE.Mesh(e,new THREE.MeshLambertMaterial({color:16711680}));return a.world.add(f),a.scene.add(g),f.position.set(b.x||0,b.y||10,b.z||0),g.position.set(b.x||0,b.y||10,b.z||0),g.castShadow=!0,g.receiveShadow=!0,a.BODIES.items.push({body:f,shape:d,mesh:g}),{body:f,shape:d,mesh:g}}function d(b){b=b?b:{};var c=new CANNON.Sphere(b.radius||.2),d=new THREE.SphereGeometry(c.radius,32,32),e=new CANNON.Body({mass:100});e.addShape(c);var f=new THREE.Mesh(d,new THREE.MeshLambertMaterial({color:16777215*Math.random()}));return a.world.add(e),a.scene.add(f),f.castShadow=!0,f.receiveShadow=!0,a.BODIES[b.array||"items"].push({body:e,shape:c,mesh:f}),{body:e,shape:c,mesh:f}}function e(b,c){var d=document.createElement("h2");document.body.appendChild(d),d.style.color="white",d.style.position="absolute",d.innerHTML=c||"BLAH BLAH BLAH",a.LABELS.push(function(){var c=THREEx.ObjCoord.cssPosition(b,a.camera,a.renderer),e=d.getBoundingClientRect();d.style.left=c.x-e.width/2+"px",d.style.top=c.y-e.height/2-70+"px",a.frustum.intersectsObject(b)?d.style.opacity=1:d.style.opacity=0})}a.load=b,a.load.box=c,a.load.label=e,a.load.ball=d}},{}],7:[function(a,b,c){"use strict";function d(a){requestAnimationFrame(d),e.camera.updateMatrixWorld(),e.camera.matrixWorldInverse.getInverse(e.camera.matrixWorld),e.cameraViewProjectionMatrix.multiplyMatrices(e.camera.projectionMatrix,e.camera.matrixWorldInverse),e.frustum.setFromMatrix(e.cameraViewProjectionMatrix);for(var b=0;b<e.BODIES.projectiles.length;b++)e.BODIES.projectiles[b].mesh.position.copy(e.BODIES.projectiles[b].body.position),e.BODIES.projectiles[b].mesh.quaternion.copy(e.BODIES.projectiles[b].body.quaternion);for(var c=0;c<e.BODIES.items.length;c++)e.BODIES.items[c].mesh.position.copy(e.BODIES.items[c].body.position),e.BODIES.items[c].mesh.quaternion.copy(e.BODIES.items[c].body.quaternion);for(var h in e.LABELS)e.LABELS[h]();e.BODIES.player.body.velocity.set(.95*e.BODIES.player.body.velocity.x,e.BODIES.player.body.velocity.y,.95*e.BODIES.player.body.velocity.z),e.MESHES.player.position.copy(e.BODIES.player.body.position),e.world.step(g),e.controls.update(Date.now()-e.delta),e.renderer.render(e.scene,e.camera),e.delta=Date.now(),f&&f.serverdata&&e&&e.updatePlayerData&&(e.updatePlayerData(),socket.emit("updatePosition",f.serverdata))}var e=a("./globals"),f=a("./player"),g=1/60;a("./init/manager")(e),a("./load")(e),a("./shooting")(e),a("./multiplayer")(e,f),d()},{"./globals":1,"./init/manager":3,"./load":6,"./multiplayer":8,"./player":9,"./shooting":10}],8:[function(a,b,c){"use strict";b.exports=function(a,b){socket.emit("requestOldPlayers",{}),socket.on("createPlayer",function(a){"undefined"==typeof b.serverdata&&(b.serverdata=a,b.id=a.id,b.inventory=b.serverdata.acc.inventory)}),socket.on("addOtherPlayer",function(c){if(c.id!==b.id){var d=a.load.box({l:1,w:1,h:2,mass:0});d.body.position.set(c.x,c.y,c.z),a.otherPlayersId.push(c.id),a.otherPlayers.push(d),a.load.label(d.mesh,c.acc.level+" - "+c.acc.username)}}),socket.on("removeOtherPlayer",function(b){a.scene.remove(d(b.id).mesh),a.world.remove(d(b.id).body),console.log(b.id+" disconnected")}),socket.on("updatePosition",function(a){var b=d(a.id);b&&(b.body.position.x=a.x,b.body.position.y=a.y,b.body.position.z=a.z)}),socket.on("bullet",function(b){alert("boi");var c=a.load.ball({array:"projectiles"});c.body.position.set(b.x,b.y,b.z),c.mesh.position.set(b.x,b.y,b.z)});var c=function(){b.serverdata.x=a.BODIES.player.body.position.x,b.serverdata.y=a.BODIES.player.body.position.y,b.serverdata.z=a.BODIES.player.body.position.z,b.serverdata.q=a.BODIES.player.body.quaternion},d=function(b){for(var c=void 0,d=0;d<a.otherPlayersId.length;d++)if(a.otherPlayersId[d]==b){c=d;break}return a.otherPlayers[c]};socket.on("clear",function(){for(var b=a.scene.children.length-1;b>=0;b--)a.scene.remove(a.scene.children[b])}),socket.on("reload",function(){window.location.reload()}),a.updatePlayerData=c,a.playerForId=d}},{}],9:[function(a,b,c){"use strict";b.exports={}},{}],10:[function(a,b,c){"use strict";b.exports=function(a){function b(b){var c=new THREE.Projector,d=b;b.set(0,0,1),c.unprojectVector(d,a.camera);var e=new THREE.Ray(a.BODIES.player.body.position,d.sub(a.BODIES.player.body.position).normalize());b.copy(e.direction)}window.addEventListener("click",function(c){if(1==a.controls.enabled){var d=new THREE.Vector3,e=15,f=a.BODIES.player.body.position.x,g=a.BODIES.player.body.position.y,h=a.BODIES.player.body.position.z,i=a.load.ball({array:"projectiles"});b(d),i.body.velocity.set(d.x*e,d.y*e,d.z*e),f+=d.x*(1.02*a.BODIES.player.shape.radius+i.shape.radius),g+=d.y*(1.02*a.BODIES.player.shape.radius+i.shape.radius),h+=d.z*(1.02*a.BODIES.player.shape.radius+i.shape.radius),i.body.position.set(f,g,h),i.mesh.position.set(f,g,h),socket.emit("bullet",{x:f,y:g,z:h})}})}},{}]},{},[1,2,3,4,5,6,7,8,9,10]);